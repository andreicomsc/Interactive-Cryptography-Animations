<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/animation.css">
  <!-- main animation library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" defer></script>
  <script type="module" src="../js/animation.js" defer></script>   
  <title>Animation</title>
</head>

<body>
  <!-- auto adjusts for variable screen sizes, resolutions -->
  <!-- maintains a constant height/width ratio for all enclosing elements -->
  <div id="enclosure">    
    <!-- header section -->  
    <div id="titleLineContainer">
      <div class="titleLogoContainer" title="Home">
        <!-- atom logo -->
        <svg id="titleLogo" viewBox="0 0 100 100">                  
          <!-- atom anti-diagonal path -->
          <g transform="translate(50, 120.7) rotate(-135)">    
            <path id="path" 
              d="M 50 41 
                 A 39 9 0 0 1 50 59 
                 A 39 9 0 0 1 50 41"                               
              stroke-width="1"
              stroke="yellow"
              fill="transparent"/>          
            <circle 
              cx="0" 
              cy="0" 
              r="2"             
              fill="red">
              <animateMotion 
                repeatCount="indefinite"
                dur="3.4s">
                <mpath xlink:href="#path"/>
              </animateMotion>
            </circle>
          </g>
          <!-- atom vertical path -->
          <g transform="translate(0, 100) rotate(-90)">    
            <path id="path" 
              d="M 50 41 
                 A 39 9 0 0 1 50 59 
                 A 39 9 0 0 1 50 41"                               
              stroke-width="1"
              stroke="yellow"
              fill="transparent"/>          
            <circle 
              cx="0" 
              cy="0" 
              r="2"             
              fill="#00ff00">
              <animateMotion 
                repeatCount="indefinite"
                dur="3.3s">
                <mpath xlink:href="#path"/>
              </animateMotion>
            </circle>
          </g>
          <!-- atom diagonal path -->
          <g transform="translate(-20.7, 50) rotate(-45)">    
            <path id="path" 
              d="M 50 41 
                 A 39 9 0 0 1 50 59 
                 A 39 9 0 0 1 50 41"                               
              stroke-width="1"
              stroke="yellow"
              fill="transparent"/>          
            <circle 
              cx="0" 
              cy="0" 
              r="2"             
              fill="blue">
              <animateMotion 
                repeatCount="indefinite"
                dur="3.2s">
                <mpath xlink:href="#path"/>
              </animateMotion>
            </circle>
          </g>
          <!-- atom horizontal path -->
          <g>    
            <path id="path" 
              d="M 50 41 
                 A 39 9 0 0 1 50 59 
                 A 39 9 0 0 1 50 41"                               
              stroke-width="1"
              stroke="yellow"
              fill="transparent"/>          
            <circle 
              cx="0" 
              cy="0" 
              r="2"             
              fill="purple">
              <animateMotion 
                repeatCount="indefinite"
                dur="3.1s">
                <mpath xlink:href="#path"/>
              </animateMotion>
            </circle>
          </g>      
        </svg>
        <!-- atom nucleus rotating polariser logo -->
        <div id="polariserLogo">
          <svg viewBox="0 0 100 100">
            <circle 
              cx="50" 
              cy="50" 
              r="45" 
              fill="#404040"/>            
            <line 
              x1="5" 
              y1="50" 
              x2="95" 
              y2="50" 
              stroke-width="20"
              stroke="#D3D3D3"/>  
            <line 
              x1="50" 
              y1="5" 
              x2="50" 
              y2="95" 
              stroke-width="20"
              stroke="#D3D3D3"/>
            <circle 
              cx="50" 
              cy="50" 
              r="45"           
              stroke-width="10"
              stroke="#000000"
              fill="transparent"/>
          </svg>
        </div>
      </div>
      <div id="title" class="header3">Quantum Key Distribution Protocol BB84</div>
      <!-- suggested next page -->
      <div class="titleLogoContainer"></div>
    </div>    

    <!-- main transmission pipe line: sender, receiver, eavesdropper -->
    <div id="participants">
      <!-- sender section -->
      <div id="alice">
        <div id="sender" class="header3">Sender</div>
        <!-- sender input data -->
        <div id="aliceInputContainer" class="data">
          <div id="aliceInputKey" style="white-space: pre">      Initial Key:</div>
          <div id="aliceInputBasis">Encoding Basis:</div>
        </div>  
        <!-- sender encoding section -->
        <div id="alicePipe">
          <div id="generatorContainer">
            <svg id="generatorBack" viewBox="0 0 100 100">
              <rect 
                x="7" 
                y="7"
                width="86" 
                height="86" 
                fill="#ff8000"/>              
            </svg>
            <!-- horizontal photon -->  
            <svg id="photonH" class="photon" viewBox="0 0 100 100">
              <!-- glowing effect + blur -->           
              <defs>            
                <filter id="glowing" 
                  x="-100%" 
                  y="-100%" 
                  height="300%" 
                  width="300%">
                  <feGaussianBlur stdDeviation="2"/>
                </filter>
              </defs>
              <!-- light wave simulation circulating path --> 
              <path id="path" 
                d="M 50 41 
                   A 39 9 0 0 1 50 59 
                   A 39 9 0 0 1 50 41" 
                filter="url(#glowing)"                     
                stroke-width="1"
                stroke="yellow"
                fill="yellow"/>            
              <circle 
                cx="0" 
                cy="0" 
                r="2" 
                filter="url(#glowing)"
                fill="yellow">
                <animateMotion 
                  repeatCount="indefinite"
                  dur="1.1s">
                  <mpath xlink:href="#path"/>
                </animateMotion>
              </circle>          
            </svg>
            <!-- vertical photon --> 
            <svg id="photonV" class="photon" transform="rotate(-90)" viewBox="0 0 100 100">
            <!-- transform="translate(0, 100) rotate(-90)" --> <!-- alternative for <g> element -->
              <!-- glowing effect + blur -->  
              <defs>            
                <filter id="glowing" 
                  x="-100%" 
                  y="-100%" 
                  height="300%" 
                  width="300%">
                  <feGaussianBlur stdDeviation="2"/>
                </filter>
              </defs>
              <!-- light wave simulation circulating path --> 
              <path id="path" 
                d="M 50 41 
                   A 39 9 0 0 1 50 59 
                   A 39 9 0 0 1 50 41" 
                filter="url(#glowing)"                     
                stroke-width="1"
                stroke="yellow"
                fill="yellow"/>             
              <circle 
                cx="0" 
                cy="0" 
                r="2" 
                filter="url(#glowing)"
                fill="yellow">
                <animateMotion 
                  repeatCount="indefinite"
                  dur="1.3s">
                  <mpath xlink:href="#path"/>
                </animateMotion>
              </circle>          
            </svg>
            <!-- diagonal photon --> 
            <svg id="photonD" class="photon" transform="rotate(-45)" viewBox="0 0 100 100">
            <!-- transform="translate(-20.7, 50) rotate(-45)" --> <!-- alternative for <g> element -->
              <!-- glowing effect + blur -->  
              <defs>            
                <filter id="glowing" 
                  x="-100%" 
                  y="-100%" 
                  height="300%" 
                  width="300%">
                  <feGaussianBlur stdDeviation="2"/>
                </filter>
              </defs>
              <!-- light wave simulation circulating path --> 
              <path id="path" 
                d="M 50 41 
                   A 39 9 0 0 1 50 59 
                   A 39 9 0 0 1 50 41" 
                filter="url(#glowing)"                     
                stroke-width="1"
                stroke="yellow"
                fill="yellow"/>           
              <circle 
                cx="0" 
                cy="0" 
                r="2" 
                filter="url(#glowing)"
                fill="yellow">
                <animateMotion 
                  repeatCount="indefinite"
                  dur="1.2s">
                  <mpath xlink:href="#path"/>
                </animateMotion>
              </circle>          
            </svg>
            <!-- anti-diagonal photon --> 
            <svg id="photonA" class="photon" transform="rotate(-135)" viewBox="0 0 100 100">
            <!-- transform="translate(50, 120.7) rotate(-135)" --> <!-- alternative for <g> element -->
              <!-- glowing effect + blur -->  
              <defs>            
                <filter id="glowing" 
                  x="-100%" 
                  y="-100%" 
                  height="300%" 
                  width="300%">
                  <feGaussianBlur stdDeviation="2"/>
                </filter>
              </defs>
              <!-- light wave simulation circulating path --> 
              <path id="path" 
                d="M 50 41 
                   A 39 9 0 0 1 50 59 
                   A 39 9 0 0 1 50 41" 
                filter="url(#glowing)"                     
                stroke-width="1"
                stroke="yellow"
                fill="yellow"/>             
              <circle 
                cx="0" 
                cy="0" 
                r="2" 
                filter="url(#glowing)"
                fill="yellow">
                <animateMotion 
                  repeatCount="indefinite"
                  dur="1.4s">
                  <mpath xlink:href="#path"/>
                </animateMotion>
              </circle>          
            </svg>
            <!-- front wall of the photon generator --> 
            <svg id="generatorFront"  viewBox="0 0 100 100">
              <!-- generator fading out window --> 
              <rect class="generatorWindow"
                x="7" 
                y="7" 
                width="86" 
                height="86" 
                fill="black"/>           
              <line 
                x1="7" 
                y1="4" 
                x2="7" 
                y2="96" 
                stroke-width="6"
                stroke="black"/>
              <!-- generator opening gates --> 
              <line id="generatorUpperGate"
                x1="93" 
                y1="4" 
                x2="93" 
                y2="50" 
                stroke-width="6"
                stroke="black"
                transform-origin="0 3"/>            
              <line id="generatorLowerGate"
                x1="93" 
                y1="50" 
                x2="93" 
                y2="96" 
                stroke-width="6"
                stroke="black"
                transform-origin="0 43"/>            
              <line 
                x1="4" 
                y1="7" 
                x2="96" 
                y2="7" 
                stroke-width="6"
                stroke="black"/>          
              <line 
                x1="4" 
                y1="93" 
                x2="96" 
                y2="93" 
                stroke-width="6"
                stroke="black"/>          
              <circle 
                cx="10" 
                cy="10" 
                r="10" 
                fill="black"/>              
              <circle 
                cx="90" 
                cy="10" 
                r="10" 
                fill="black"/>              
              <circle 
                cx="90" 
                cy="90" 
                r="10" 
                fill="black"/>              
              <circle 
                cx="10" 
                cy="90" 
                r="10" 
                fill="black"/>          
            </svg>
          </div>
          <!-- sender polariser, created dynamically in js --> 
          <div id="polariserContainer"></div>
        </div>
        <!-- sender output data --> 
        <div id="aliceOutputContainer" class="data"></div>
      </div>
      <div class="delimiterVertical"></div>

      <!-- middle section -->
      <div id="middle">
        <!-- legend containing all visible elements with short desctiption -->
        <div id="legend">
          <div class="legendCells">
            <div>Generator</div>
            <!-- the order of photons is different from the main generator, use angles for guidance -->
            <svg id="generatorLegend" viewBox="0 0 100 100">
              <defs>            
                <filter id="glowing" 
                  x="-100%" 
                  y="-100%" 
                  height="300%" 
                  width="300%">
                  <feGaussianBlur stdDeviation="2"/>
                </filter>
              </defs>
              <rect 
                x="7" 
                y="7"
                width="86" 
                height="86" 
                fill="#ff8000"/> 
              <g transform="translate(0, 100) rotate(-90)">
                <path id="path" 
                  d="M 50 41 
                     A 39 9 0 0 1 50 59 
                     A 39 9 0 0 1 50 41" 
                  filter="url(#glowing)"                     
                  stroke-width="1"
                  stroke="yellow"
                  fill="yellow"/>                
                <circle 
                  cx="0" 
                  cy="0" 
                  r="2" 
                  filter="url(#glowing)"
                  fill="yellow">
                  <animateMotion 
                    repeatCount="indefinite"
                    dur="1.3s">
                    <mpath xlink:href="#path"/>
                  </animateMotion>
                </circle>
              </g>              
              <g>
                <path id="path" 
                  d="M 50 41 
                     A 39 9 0 0 1 50 59 
                     A 39 9 0 0 1 50 41" 
                  filter="url(#glowing)"                     
                  stroke-width="1"
                  stroke="yellow"
                  fill="yellow"/>                
                <circle 
                  cx="0" 
                  cy="0" 
                  r="2" 
                  filter="url(#glowing)"
                  fill="yellow">
                  <animateMotion 
                    repeatCount="indefinite"
                    dur="1.1s">
                    <mpath xlink:href="#path"/>
                  </animateMotion>
                </circle>
              </g>                
              <g transform="translate(50, 120.7) rotate(-135)">
                <path id="path" 
                  d="M 50 41 
                     A 39 9 0 0 1 50 59 
                     A 39 9 0 0 1 50 41" 
                  filter="url(#glowing)"                     
                  stroke-width="1"
                  stroke="yellow"
                  fill="yellow"/>                
                <circle 
                  cx="0" 
                  cy="0" 
                  r="2" 
                  filter="url(#glowing)"
                  fill="yellow">
                  <animateMotion 
                    repeatCount="indefinite"
                    dur="1.4s">
                    <mpath xlink:href="#path"/>
                  </animateMotion>
                </circle>
              </g>
              <g transform="translate(-20.7, 50) rotate(-45)">
                <path id="path" 
                  d="M 50 41 
                     A 39 9 0 0 1 50 59 
                     A 39 9 0 0 1 50 41" 
                  filter="url(#glowing)"                     
                  stroke-width="1"
                  stroke="yellow"
                  fill="yellow"/>                
                <circle 
                  cx="0" 
                  cy="0" 
                  r="2" 
                  filter="url(#glowing)"
                  fill="yellow">
                  <animateMotion 
                    repeatCount="indefinite"
                    dur="1.2s">
                    <mpath xlink:href="#path"/>
                  </animateMotion>
                </circle>
              </g>             
              <rect class="generatorWindow"
                x="7" 
                y="7" 
                width="86" 
                height="86" 
                fill="black"/> 
              <line 
                x1="7" 
                y1="4" 
                x2="7" 
                y2="96" 
                stroke-width="6"
                stroke="black"/>
              <line
                x1="93" 
                y1="4" 
                x2="93" 
                y2="50" 
                stroke-width="6"
                stroke="black"/>              
              <line
                x1="93" 
                y1="50" 
                x2="93" 
                y2="96" 
                stroke-width="6"
                stroke="black"/>              
              <line 
                x1="4" 
                y1="7" 
                x2="96" 
                y2="7" 
                stroke-width="6"
                stroke="black"/>
              <line 
                x1="4" 
                y1="93" 
                x2="96" 
                y2="93" 
                stroke-width="6"
                stroke="black"/>
              <circle 
                cx="10" 
                cy="10" 
                r="10" 
                fill="black"/>                
              <circle 
                cx="90" 
                cy="10" 
                r="10" 
                fill="black"/>                
              <circle 
                cx="90" 
                cy="90" 
                r="10" 
                fill="black"/>                
              <circle 
                cx="10" 
                cy="90" 
                r="10" 
                fill="black"/>      
            </svg>
          </div>
          <!-- legend header -->
          <div class="legendCells">Basis Encoding Bit</div>  
          <div class="legendCells">Basis Encoding</div>
          <div class="legendCells">Polarisers</div>
          <div class="legendCells">Polarised Photons</div>
          <div class="legendCells">Key Bits</div>
          <div class="legendCells">Measuring Device</div>
          <div class="legendCells">Rectilinear</div>          
          <div class="legendCells">
            <!-- bit 0 template used to generate all other bits "0" -->
            <svg id="templateBit0" viewBox="0 0 100 100">      
              <circle 
                cx="50" 
                cy="50" 
                r="50" 
                fill="gray"/>
              <path
                d="M 34 50 
                   A 8 14 0 0 1 66 50 
                   A 8 14 0 0 1 34 50" 
                stroke-width="10"
                stroke="white"
                fill="transparent"/>      
            </svg>                        
          </div>
          <!-- polariser template used to generate all other polarisers, measuring devices -->
          <div class="legendCells">
            <svg id="templatePolariser" viewBox="0 0 100 100">
              <circle 
                cx="50" 
                cy="50" 
                r="45" 
                fill="#404040"/>
              <line 
                x1="50" 
                y1="5" 
                x2="50" 
                y2="95" 
                stroke-width="20"
                stroke="#808080"/>
              <line 
                x1="5" 
                y1="50" 
                x2="95" 
                y2="50" 
                stroke-width="20"
                stroke="#808080"/>  
              <circle 
                cx="50" 
                cy="50" 
                r="45"           
                stroke-width="10"
                stroke="#000000"
                fill="transparent"/>
            </svg>
          </div>
          <!-- content added through js -->
          <div class="legendCells"></div>
          <div class="legendCells"></div>
          <div class="legendCells"></div>
          <div class="legendCells"></div>
          <div class="legendCells">Diagonal</div>
          <div class="legendCells">
            <!-- bit 1 template used to generate all other bits "1" -->
            <svg id="templateBit1" viewBox="0 0 100 100">    
              <circle 
                cx="50" 
                cy="50" 
                r="50" 
                fill="gray"/>
              <line 
                x1="34" 
                y1="50"  
                x2="53" 
                y2="23" 
                stroke-width="10"
                stroke="white"/>
              <line 
                x1="54" 
                y1="20" 
                x2="54" 
                y2="80" 
                stroke-width="10"
                stroke="white"/>      
            </svg>
          </div>
          <!-- content added through js -->
          <div class="legendCells"></div>
          <div class="legendCells"></div>
          <div class="legendCells"></div>
          <div class="legendCells"></div>
          <div class="legendCells"></div>
        </div> 
        <!-- quntum channel, also used to display user messages -->
        <div id="channel">
          <div id="message1" class="message header3">Quantum Channel<br>(e.g. Optical fiber)</div>
          <div id="message10" class="message header2">Transmissions Completed.</div>
          <div id="message20" class="message header2">Results Analysis Stage.<br><br>Now Sender and Receiver will communicate through the authenticated classical channel.</div>
          <div id="message30" class="message header2">Sender and Receiver aknowledge the transmission of all bits.</div>
          <div id="message40" class="message header2">Sender and Receiver compare their bases choices.</div>
          <div id="message50" class="message header2">Sender and Receiver mark all non-matching bases.</div>
          <div id="message60" class="message header2">All non-matching bases' transmissions are discarded.</div>
          <div id="message70" class="message header2">Checking for the Eavesdropper presence.</div>
          <div id="message80" class="message header2">Sender and Receiver share a subset of their output Key bits.</div>
          <div id="message90" class="message header2">All shared Key bits matched.<br>These transmissions are discarded.</div>
          <div id="message100" class="message header2"></div>
          <div id="message110" class="message header2">Non-matching Key bits detected.</div>
          <div id="message120" class="message header2">Eavesdropper detected.<br>Quantum channel is not safe.<br>Secret key not achieved.</div>
          <div id="message130" class="message header1"></div>
          <div id="message150" class="message header2">Animation Completed.</div>
        </div>  
        <!-- eavesdropper section, content added through js -->
        <div id="eve">
          <div id="eveDeviceContainer"></div>  
          <div id="eveInterferenceContainer"></div>           
          <div id="eavesdropper" class="header3">Eavesdropper</div>             
        </div>
      </div>
      <div class="delimiterVertical"></div>
      <!-- receiver section, content added through js -->
      <div id="bob">        
        <div id="receiver" class="header3">Receiver</div>         
        <div id="bobInputContainer" class="data">
          <div id="bobInputBasis" class="baseFontMinus">Measuring Basis:</div>
        </div>        
        <div id="bobPipe">
          <div id="bobDeviceContainer"></div>
        </div>
        <div id="bobOutputContainer" class="data"></div>      
      </div>
    </div>
    <div id="delimiterHorizontal"></div>

    <!-- control buttons -->
    <div id="controls">      
      <button onclick="window.location.replace('../html/input.html')" class="header1">New Input</button>           
      <button id="reverse" class="header1">Reverse</button>
      <button id="play" class="header1">Play</button> 
      <button id="restart" class="header1">Restart</button>
      <button id="jumpButton" class="header1">Complete transmissions</button>
    </div>

    <!-- timeline dragger rail -->
    <div id="timelineDraggerRail">
      <div id="timelineDragger"></div>
    </div>
  </div>
  
</body>
</html>